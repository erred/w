!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).firebase=t()}(this,function(){"use strict";function e(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(t[r],n[r]));return t}const t="FirebaseError";class n extends Error{constructor(e,i){super(i),this.code=e,this.name=t,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r.prototype.create)}}class r{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const r=t[0]||{},o=`${this.service}/${e}`,s=this.errors[e],a=s?function(e,t){return e.replace(i,(e,n)=>{const r=t[n];return null!=r?r.toString():`<${n}?>`})}(s,r):"Error",c=`${this.serviceName}: ${a} (${o}).`,u=new n(o,c);for(const e of Object.keys(r))"_"!==e.slice(-1)&&(e in u&&console.warn(`Overwriting FirebaseError base field "${e}" can cause unexpected behavior.`),u[e]=r[e]);return u}}const i=/\{\$([^}]+)}/g,o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s=new r("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."}),a="[DEFAULT]";class c{constructor(t,n,r){this.firebase_=r,this.isDeleted_=!1,this.services_={},this.INTERNAL={},this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=e(void 0,t)}get automaticDataCollectionEnabled(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_}set automaticDataCollectionEnabled(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e}get name(){return this.checkDestroyed_(),this.name_}get options(){return this.checkDestroyed_(),this.options_}delete(){return new Promise(e=>{this.checkDestroyed_(),e()}).then(()=>{this.firebase_.INTERNAL.removeApp(this.name_);const e=[];for(const t of Object.keys(this.services_))for(const n of Object.keys(this.services_[t]))e.push(this.services_[t][n]);return Promise.all(e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()))}).then(()=>{this.isDeleted_=!0,this.services_={}})}_getService(e,t=a){if(this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){const n=t!==a?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]}extendApp(t){e(this,t)}checkDestroyed_(){if(this.isDeleted_)throw s.create("app-deleted",{name:this.name_})}}const u="6.2.0";const l=function(){const t=function(t){const n={},r={},i={},c={__esModule:!0,initializeApp:function(e,r={}){if("object"!=typeof r||null===r){const e=r;r={name:e}}const i=r;void 0===i.name&&(i.name=a);const{name:u}=i;if("string"!=typeof u||!u)throw s.create("bad-app-name",{name:String(u)});if(o(n,u))throw s.create("duplicate-app",{name:u});const l=new t(e,i,c);return n[u]=l,p(l,"create"),l},app:l,apps:null,SDK_VERSION:u,INTERNAL:{registerService:function(n,o,a,u,p=!1){if(r[n])throw s.create("duplicate-service",{name:n});function h(e=l()){if("function"!=typeof e[n])throw s.create("invalid-app-argument",{name:n});return e[n]()}return r[n]=o,u&&(i[n]=u,f().forEach(e=>{u("create",e)})),void 0!==a&&e(h,a),c[n]=h,t.prototype[n]=function(...e){return this._getService.bind(this,n).apply(this,p?e:[])},h},removeApp:function(e){p(n[e],"delete"),delete n[e]},factories:r,useAsService:h}};function l(e){if(!o(n,e=e||a))throw s.create("no-app",{name:e});return n[e]}function f(){return Object.keys(n).map(e=>n[e])}function p(e,t){for(const n of Object.keys(r)){const r=h(0,n);if(null===r)return;i[r]&&i[r](t,e)}}function h(e,t){return"serverAuth"===t?null:t}return c.default=c,Object.defineProperty(c,"apps",{get:f}),l.App=t,c}(c);t.SDK_VERSION=`${t.SDK_VERSION}_LITE`;const n=t.INTERNAL.registerService;return t.INTERNAL.registerService=function(e,t,r,i,o){if("performance"!==e&&"installations"!==e)throw Error(`${e} cannot register with the standalone perf instance`);return n(e,t,r,i,o)},t}();function f(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function p(e,t,n){var r,i=new Promise(function(i,o){f(r=e[t].apply(e,n)).then(i,o)});return i.request=r,i}function h(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function d(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return p(this[t],r,arguments)})})}function g(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function m(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return e=this[t],(n=p(e,r,arguments)).then(function(e){if(e)return new b(e,n.request)});var e,n})})}function _(e){this._index=e}function b(e,t){this._cursor=e,this._request=t}function y(e){this._store=e}function w(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function v(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new w(n)}function E(e){this._db=e}h(_,"_index",["name","keyPath","multiEntry","unique"]),d(_,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),m(_,"_index",IDBIndex,["openCursor","openKeyCursor"]),h(b,"_cursor",["direction","key","primaryKey","value"]),d(b,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(b.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,n),f(t._request).then(function(e){if(e)return new b(e,t._request)})})})}),y.prototype.createIndex=function(){return new _(this._store.createIndex.apply(this._store,arguments))},y.prototype.index=function(){return new _(this._store.index.apply(this._store,arguments))},h(y,"_store",["name","keyPath","indexNames","autoIncrement"]),d(y,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),m(y,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),g(y,"_store",IDBObjectStore,["deleteIndex"]),w.prototype.objectStore=function(){return new y(this._tx.objectStore.apply(this._tx,arguments))},h(w,"_tx",["objectStoreNames","mode"]),g(w,"_tx",IDBTransaction,["abort"]),v.prototype.createObjectStore=function(){return new y(this._db.createObjectStore.apply(this._db,arguments))},h(v,"_db",["name","version","objectStoreNames"]),g(v,"_db",IDBDatabase,["deleteObjectStore","close"]),E.prototype.transaction=function(){return new w(this._db.transaction.apply(this._db,arguments))},h(E,"_db",["name","version","objectStoreNames"]),g(E,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[y,_].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],i=this._store||this._index,o=i[e].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[_,y].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)})})})});const I=1e4,S="w:0.1.6",T="FIS_v2",A="https://firebaseinstallations.googleapis.com/v1",N=36e5,k=new r("installations","Installations",{"missing-app-config-values":"Missing App configuration values.","create-installation-failed":"Could not register Firebase Installation.","generate-token-failed":"Could not generate Auth Token.","not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function O(e){return e instanceof n&&e.code.includes("request-failed")}function D(e){if(!e||!e.options)throw k.create("missing-app-config-values");const t=e.name,{projectId:n,apiKey:r,appId:i}=e.options;if(!(t&&n&&r&&i))throw k.create("missing-app-config-values");return{appName:t,projectId:n,apiKey:r,appId:i}}function R({projectId:e}){return`${A}/projects/${e}/installations`}function j(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function P(e,t){const n=(await t.json()).error;return k.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function $({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function M(e,{refreshToken:t}){const n=$(e);return n.append("Authorization",function(e){return`${T} ${e}`}(t)),n}async function C(e){const t=await e();return t.status>=500&&t.status<600?e():t}function L(e){return new Promise(t=>{setTimeout(t,e)})}function B(){const e=new Uint8Array(17);return crypto.getRandomValues(e),e[0]=112+e[0]%16,function(e){return function(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e)}const U="firebase-installations-store",F=function(e,t,n){var r=p(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new v(i.result,e.oldVersion,i.transaction))}),r.then(function(e){return new E(e)})}("firebase-installations-database",1,e=>{switch(e.oldVersion){case 0:e.createObjectStore(U)}});async function q(e,t){const n=V(e),r=(await F).transaction(U,"readwrite");return r.objectStore(U).put(t,n),await r.complete,t}async function x(e){const t=V(e),n=(await F).transaction(U,"readwrite");return n.objectStore(U).delete(t),n.complete}async function K(e,t){const n=V(e),r=(await F).transaction(U,"readwrite"),i=r.objectStore(U),o=await i.get(n),s=t(o);return s===o?s:(void 0===s?i.delete(n):i.put(s,n),await r.complete,s)}function V(e){return`${e.appName}!${e.appId}`}async function H(e){let t;return{installationEntry:await K(e,n=>{const r=function(e){const t=e||{fid:B(),registrationStatus:0};if(z(t))return{fid:t.fid,registrationStatus:0};return t}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){const e=Promise.reject(k.create("app-offline"));return{installationEntry:t,registrationPromise:e}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,{fid:t}){const n=R(e),r=$(e),i={fid:t,authVersion:T,appId:e.appId,sdkVersion:S},o={method:"POST",headers:r,body:JSON.stringify(i)},s=await C(()=>fetch(n,o));if(s.ok){const e=await s.json();return{fid:t,registrationStatus:2,refreshToken:e.refreshToken,authToken:j(e.authToken)}}throw await P("Create Installation",s)}(e,t);await q(e,n)}catch(n){throw O(n)&&409===n.serverCode?await x(e):await q(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:W(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}),registrationPromise:t}}async function W(e){let t=await J(e);for(;1===t.registrationStatus;)await L(100),t=await J(e);if(0===t.registrationStatus)throw k.create("create-installation-failed")}function J(e){return K(e,e=>{if(!e)throw k.create("installation-not-found");return z(e)?{fid:e.fid,registrationStatus:0}:e})}function z(e){return 1===e.registrationStatus&&e.registrationTime+I<Date.now()}async function G(e,t){const n=function(e,{fid:t}){return`${R(e)}/${t}/authTokens:generate`}(e,t),r=M(e,t),i={installation:{sdkVersion:S}},o={method:"POST",headers:r,body:JSON.stringify(i)},s=await C(()=>fetch(n,o));if(s.ok){return j(await s.json())}throw await P("Generate Auth Token",s)}async function Q(e){const t=D(e);return await async function(e){const{installationEntry:t,registrationPromise:n}=await H(e);if(n)await n;else if(2!==t.registrationStatus)throw k.create("create-installation-failed")}(t),async function(e){let t;const n=await K(e,n=>{if(!Y(n))throw k.create("not-registered");const r=n.authToken;if(function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+N}(e)}(r))return n;if(1===r.requestStatus)return t=async function(e){let t=await X(e);for(;1===t.authToken.requestStatus;)await L(100),t=await X(e);const n=t.authToken;if(0===n.requestStatus)throw k.create("generate-token-failed");return n}(e),n;{if(!navigator.onLine)throw k.create("app-offline");const r=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign({},e,{authToken:t})}(n);return t=async function(e,t){try{const n=await G(e,t),r=Object.assign({},t,{authToken:n});return await q(e,r),n}catch(n){if(!O(n)||401!==n.serverCode&&404!==n.serverCode){const n=Object.assign({},t,{authToken:{requestStatus:0}});await q(e,n)}else await x(e);throw n}}(e,r),r}});return(t?await t:n.authToken).token}(t)}function X(e){return K(e,e=>{if(!Y(e))throw k.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+I<Date.now()}(e.authToken)?Object.assign({},e,{authToken:{requestStatus:0}}):e})}function Y(e){return void 0!==e&&2===e.registrationStatus}async function Z(e,t){const n=function(e,{fid:t}){return`${R(e)}/${t}`}(e,t),r={method:"DELETE",headers:M(e,t)},i=await C(()=>fetch(n,r));if(!i.ok)throw await P("Delete Installation",i)}var ee;l.INTERNAL.registerService("installations",e=>(D(e),{app:e,getId:()=>(async function(e){const t=D(e),{installationEntry:n,registrationPromise:r}=await H(t);return r&&r.catch(()=>{}),n.fid})(e),getToken:()=>Q(e),delete:()=>(async function(e){const t=D(e),n=await K(t,e=>{if(!e||0!==e.registrationStatus)return e});if(n){if(1===n.registrationStatus)throw k.create("delete-pending-registration");if(2===n.registrationStatus){if(!navigator.onLine)throw k.create("app-offline");await Z(t,n),await x(t)}}})(e)})),function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ee||(ee={}));const te=ee.INFO,ne=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString();switch(t){case ee.DEBUG:case ee.VERBOSE:console.log(`[${r}]  ${e.name}:`,...n);break;case ee.INFO:console.info(`[${r}]  ${e.name}:`,...n);break;case ee.WARN:console.warn(`[${r}]  ${e.name}:`,...n);break;case ee.ERROR:console.error(`[${r}]  ${e.name}:`,...n);break;default:throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)}};class re{constructor(e){this.name=e,this._logLevel=te,this._logHandler=ne}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ee))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}debug(...e){this._logHandler(this,ee.DEBUG,...e)}log(...e){this._logHandler(this,ee.VERBOSE,...e)}info(...e){this._logHandler(this,ee.INFO,...e)}warn(...e){this._logHandler(this,ee.WARN,...e)}error(...e){this._logHandler(this,ee.ERROR,...e)}}const ie="0.2.7",oe="FB-PERF-TRACE-START",se="FB-PERF-TRACE-STOP",ae="FB-PERF-TRACE-MEASURE",ce="_wt_",ue="_fp",le="_fcp",fe="_fid",pe="@firebase/performance/config",he="@firebase/performance/configexpire",de=new r("performance","Performance",{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok"});let ge,me,_e,be;class ye{constructor(e){if(!e)throw de.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.localStorage=e.localStorage,e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(e=>{for(const n of e.getEntries())t(n)}).observe({entryTypes:[e]})}static getInstance(){return void 0===ge&&(ge=new ye(me)),ge}}class we{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getAppId(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!e)throw de.create("no app id");return e}getProjectId(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!e)throw de.create("no project id");return e}getApiKey(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!e)throw de.create("no api key");return e}static getInstance(){return void 0===_e&&(_e=new we),_e}}function ve(){return be}var Ee;function Ie(){const e=ye.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function Se(){switch(ye.getInstance().document.visibilityState){case"visible":return Ee.VISIBLE;case"hidden":return Ee.HIDDEN;case"prerender":return Ee.PRERENDER;default:return Ee.UNKNOWN}}function Te(){const e=ye.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN",e[e.PRERENDER=3]="PRERENDER",e[e.UNLOADED=4]="UNLOADED"}(Ee||(Ee={}));const Ae=new re("Performance");Ae.logLevel=ee.INFO;const Ne="0.0.1",ke={loggingEnabled:!0},Oe="FIREBASE_INSTALLATIONS_AUTH";function De(e){const t=function(){const e=ye.getInstance().localStorage,t=e.getItem(he);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(pe);if(!r)return;try{const e=JSON.parse(r);return e}catch(e){return}}();return t?(je(t),Promise.resolve()):function(e){return function(){const e=we.getInstance().firebaseAppInstance.installations().getToken();return e.then(e=>{}),e}().then(t=>{const n=we.getInstance().getProjectId(),r=`https://firebaseremoteconfig.googleapis.com/v1/projects/${n}/namespaces/fireperf:fetch?key=${we.getInstance().getApiKey()}`,i=new Request(r,{method:"POST",headers:{Authorization:`${Oe} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:we.getInstance().getAppId(),app_version:ie,sdk_version:Ne})});return fetch(i).then(e=>{if(e.ok)return e.json();throw de.create("RC response not ok")})}).catch(()=>{Ae.info(Re)})}(e).then(e=>je(e)).then(e=>(function(e){if(!e)return;const t=ye.getInstance().localStorage;t.setItem(pe,JSON.stringify(e)),t.setItem(he,String(Date.now()+60*we.getInstance().configTimeToLive*60*1e3))})(e),()=>{})}const Re="Could not fetch config, will use default configs";function je(e){if(!e)return e;const t=we.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=ke.loggingEnabled,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=Pe(t.tracesSamplingRate),t.logNetworkAfterSampling=Pe(t.networkRequestsSamplingRate),e}function Pe(e){return Math.random()<=e}let $e,Me=1;function Ce(){return Me=2,$e=$e||function(){const e=ye.getInstance().document;return new Promise(t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()})}().then(()=>(function(){const e=we.getInstance().firebaseAppInstance.installations().getId();return e.then(e=>{be=e}),e})()).then(e=>De(e)).then(()=>Le(),()=>Le())}function Le(){Me=3}const Be=1e4,Ue=3;let Fe,qe=Ue,xe=[];function Ke(e){return(t,n,...r)=>{!function(e){if(!e.eventTime||!e.message)throw de.create("invalid cc log");xe=[...xe,e]}({message:e(...r),eventTime:Date.now()})}}function Ve(){if(Fe)return Fe;const e=Ke(Je);return(Fe=new re("@firebase/performance/cc")).logHandler=e,Fe}function He(e){const t=we.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&(e.isAuto&&Se()!==Ee.VISIBLE||t.loggingEnabled&&t.logTraceAfterSampling&&(3===Me?We(e):Ce().then(()=>We(e),()=>We(e))))}function We(e){ve()&&setTimeout(()=>Ve().log(e,1),0)}function Je(e,t){return 0===t?function(e){const t={url:e.url,http_method:1,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:ze(),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=Ge(e.counters));const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=Ge(n));const r={application_info:ze(),trace_metric:t};return JSON.stringify(r)}(e)}function ze(){return{google_app_id:we.getInstance().getAppId(),app_instance_id:ve(),web_app_info:{sdk_version:ie,page_url:ye.getInstance().getUrl(),service_worker_status:Ie(),visibility_state:Se(),effective_connection_type:Te()},application_process_state:0}}function Ge(e){return Object.keys(e).map(t=>({key:t,value:e[t]}))}!function e(t){setTimeout(()=>{if(0===qe)return;if(!xe.length)return e(Be);const t=[...xe];xe=[];const n=t.map(e=>({source_extension_json:e.message,event_time_ms:String(e.eventTime)})),r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:we.getInstance().logSource,log_event:n};fetch(we.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(r)}).then(e=>(e.ok||Ae.info("Call to Firebase backend failed."),e.json())).then(t=>{const n=Number(t.next_request_wait_millis),r=isNaN(n)?Be:Math.max(Be,n);qe=Ue,e(r)}).catch(()=>{xe=[...t,...xe],qe--,Ae.info(`Tries left: ${qe}.`),e(Be)})},t)}(5500);class Qe{constructor(e,t=!1,n){this.name=e,this.isAuto=t,this.state=1,this.customAttributes={},this.counters={},this.api=ye.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`${oe}-${this.randomId}-${this.name}`,this.traceStopMark=`${se}-${this.randomId}-${this.name}`,this.traceMeasure=n||`${ae}-${this.randomId}-${this.name}`,n&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw de.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw de.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),He(this)}record(e,t,n){if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));He(this)}incrementMetric(e,t=1){void 0===this.counters[e]&&(this.counters[e]=0),this.counters[e]+=t}putMetric(e,t){this.counters[e]=t}getMetric(e){return this.counters[e]||0}putAttribute(e,t){this.customAttributes[e]=t}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n){const r=ye.getInstance().getUrl();if(!r)return;const i=new Qe(ce+r,!0),o=Math.floor(1e3*ye.getInstance().getTimeOrigin());i.setStartTime(o),e&&e[0]&&(i.setDuration(Math.floor(1e3*e[0].duration)),i.incrementMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),i.incrementMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),i.incrementMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(t){const e=t.find(e=>"first-paint"===e.name);e&&e.startTime&&i.incrementMetric(ue,Math.floor(1e3*e.startTime));const r=t.find(e=>"first-contentful-paint"===e.name);r&&r.startTime&&i.incrementMetric(le,Math.floor(1e3*r.startTime)),n&&i.incrementMetric(fe,Math.floor(1e3*n))}He(i)}static createUserTimingTrace(e){He(new Qe(e,!1,e))}}function Xe(e){const t=e;if(!t||void 0===t.responseStart)return;const n=ye.getInstance().getTimeOrigin(),r=Math.floor(1e3*(t.startTime+n)),i=t.responseStart?Math.floor(1e3*(t.responseStart-t.startTime)):void 0,o=Math.floor(1e3*(t.responseEnd-t.startTime));!function(e){const t=we.getInstance();t.instrumentationEnabled&&e.url!==t.logEndPointUrl.split("?")[0]&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout(()=>Ve().log(e,0),0)}({url:t.name&&t.name.split("?")[0],responsePayloadBytes:t.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}const Ye=5e3;function Ze(){ve()&&(setTimeout(()=>(function(){const e=ye.getInstance(),t=e.getEntriesByType("navigation"),n=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{Qe.createOobTrace(t,n),r=void 0},Ye);e.onFirstInputDelay(e=>{r&&(clearTimeout(r),Qe.createOobTrace(t,n,e))})}else Qe.createOobTrace(t,n)})(),0),setTimeout(()=>(function(){const e=ye.getInstance(),t=e.getEntriesByType("resource");for(const e of t)Xe(e);e.setupObserver("resource",Xe)})(),0),setTimeout(()=>(function(){const e=ye.getInstance(),t=e.getEntriesByType("measure");for(const e of t)et(e);e.setupObserver("measure",et)})(),0))}function et(e){const t=e.name;t.substring(0,ae.length)!==ae&&Qe.createUserTimingTrace(t)}class tt{constructor(e){this.app=e,Ce().then(Ze,Ze)}trace(e){return new Qe(e)}set instrumentationEnabled(e){we.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return we.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){we.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return we.getInstance().dataCollectionEnabled}}const nt="[DEFAULT]";return window&&fetch&&Promise?(function(e){me=e}(window),function(e){e.INTERNAL.registerService("performance",e=>{if(e.name!==nt)throw de.create("FB not default");return we.getInstance().firebaseAppInstance=e,new tt(e)},{})}(l)):Ae.info("Firebase Performance cannot start if browser does not support fetch and Promise."),l});
//# sourceMappingURL=firebase-performance-standalone.es2017.js.map
